window.type = "";
window.serveStatic = true;
window.filePrefix = { file_prefix: "app/services" }; 
window.values = [{"file_path":"app/services/tenant_template_service.rb","x":138,"y":1573.7249918111254,"details":{"TenantTemplateService#available_templates":11.88696765369537,"TenantTemplateService#resolve_and_apply_template":2.2,"TenantTemplateService#apply_template":61.87309593029917,"TenantTemplateService#restore_template_attributes":76.63589237426552,"TenantTemplateService#tenant_to_template":150.894135074893,"TenantTemplateService#template_locales":20.392400545301197,"TenantTemplateService#change_locales":21.810777152591346,"TenantTemplateService#required_locales":9.467840302835706,"TenantTemplateService#translate_and_fix_locales":92.17125365318631,"TenantTemplateService#none":1.000000000000001,"TenantTemplateService#get_model_class":3.9038442591886313,"TenantTemplateService#available_external_templates":13.388054376943659,"TenantTemplateService#resolve_template":45.581355837666834,"TenantTemplateService#init_refs":1.0000000000000018,"TenantTemplateService#lookup_ref":9.441398201537751,"TenantTemplateService#store_ref":1.4142135623730976,"TenantTemplateService#yml_areas":13.689411966918104,"TenantTemplateService#yml_custom_forms":10.12126474310401,"TenantTemplateService#yml_custom_fields":34.64592328110197,"TenantTemplateService#yml_custom_field_options":16.275134408047165,"TenantTemplateService#yml_topics":16.076069171286893,"TenantTemplateService#yml_users":33.500680963228255,"TenantTemplateService#yml_project_folders":25.647611974606956,"TenantTemplateService#yml_project_folder_images":11.643023662262324,"TenantTemplateService#yml_project_folder_files":12.739309243440182,"TenantTemplateService#yml_projects":53.56724745588488,"TenantTemplateService#yml_project_files":12.739309243440182,"TenantTemplateService#yml_project_images":11.643023662262324,"TenantTemplateService#yml_projects_topics":12.938701635017347,"TenantTemplateService#yml_phases":41.78624175491264,"TenantTemplateService#yml_phase_files":12.739309243440182,"TenantTemplateService#yml_participation_context":14.966963619919731,"TenantTemplateService#yml_areas_projects":7.071067811865486,"TenantTemplateService#yml_campaigns":30.802110317314348,"TenantTemplateService#yml_unsubscription_tokens":8.621484790916249,"TenantTemplateService#yml_baskets":17.86840787535367,"TenantTemplateService#yml_events":33.59360058106311,"TenantTemplateService#yml_event_files":12.739309243440182,"TenantTemplateService#yml_groups":13.689411966918104,"TenantTemplateService#yml_groups_projects":14.83374531263095,"TenantTemplateService#yml_permissions":15.081114017207108,"TenantTemplateService#yml_groups_permissions":14.83374531263095,"TenantTemplateService#yml_memberships":16.466936569987777,"TenantTemplateService#yml_pages":29.6062493402998,"TenantTemplateService#yml_page_links":8.161494961096293,"TenantTemplateService#yml_page_files":12.739309243440182,"TenantTemplateService#yml_idea_statuses":16.076069171286893,"TenantTemplateService#yml_ideas":43.97146802188899,"TenantTemplateService#yml_areas_ideas":17.97470444819611,"TenantTemplateService#yml_baskets_ideas":17.055790805471343,"TenantTemplateService#yml_idea_files":17.52854814295813,"TenantTemplateService#yml_idea_images":16.43045951883272,"TenantTemplateService#yml_ideas_phases":16.63009320478995,"TenantTemplateService#yml_ideas_topics":11.842297074469988,"TenantTemplateService#yml_initiative_statuses":16.076069171286893,"TenantTemplateService#yml_initiatives":33.39416116628779,"TenantTemplateService#yml_initiative_status_changes":13.237824594698354,"TenantTemplateService#yml_areas_initiatives":14.221462653327912,"TenantTemplateService#yml_initiative_files":14.135416513141758,"TenantTemplateService#yml_initiative_images":13.03840481040532,"TenantTemplateService#yml_initiatives_topics":8.459314393022655,"TenantTemplateService#yml_official_feedback":20.459716518075254,"TenantTemplateService#yml_comments":30.679797913284943,"TenantTemplateService#yml_votes":20.85857137965113,"TenantTemplateService#yml_poll_questions":15.081114017207108,"TenantTemplateService#yml_poll_options":15.081114017207108,"TenantTemplateService#yml_poll_responses":15.280052355931272,"TenantTemplateService#yml_poll_response_options":15.280052355931272,"TenantTemplateService#yml_volunteering_causes":17.469974241537997,"TenantTemplateService#yml_volunteering_volunteers":15.280052355931272,"TenantTemplateService#yml_maps_map_configs":17.768792868397142,"TenantTemplateService#yml_maps_layers":14.882204137828534,"TenantTemplateService#yml_maps_legend_items":11.643023662262328},"history":[["0d8dd319a","input term added"],["a1b5a908b","Merge branch 'fix/os/project-folders/migrations' of github.com:CitizenLabDotCo/cl2-back into fix/os/project-folders/migrations"],["256a915e7","fix tenant template creation: use new model names"],["71fbf56ba","convert on the fly old/legacy class names from older templates."],["b0a8a8047","merge from master"],["aff0c1427","Merge branch 'master' into CL2-5918-default-idea-sorting"],["b9d00117b","no more global text images in template, all should be nested"],["13e178560","Merge branch 'master' into CL2-5918-default-idea-sorting"],["a438d70cb","Merge branch 'master' of github.com:CitizenLabDotCo/cl2-back into CL2-5859/images-in-idea-bodies"],["3727d162f","Add text_images to project copy service and tenant template service"]]},{"file_path":"app/services/xlsx_service.rb","x":56,"y":430.3548441678181,"details":{"XlsxService#none":4.000000000000001,"XlsxService#escape_formula":6.326136261573884,"XlsxService#hash_array_to_xlsx":18.7136313953225,"XlsxService#xlsx_to_hash_array":29.271146202361127,"XlsxService#generate_xlsx":6.685057965343311,"XlsxService#generate_sheet":25.358824893910214,"XlsxService#generate_time_stats_xlsx":4.1744011546568,"XlsxService#generate_field_stats_xlsx":6.520400677872493,"XlsxService#generate_res_stats_xlsx":7.785242449660773,"XlsxService#generate_votes_by_time_xlsx":6.794115100585216,"XlsxService#generate_users_xlsx":46.52236021527717,"XlsxService#generate_ideas_xlsx":105.58869494410852,"XlsxService#generate_initiatives_xlsx":71.59532107617096,"XlsxService#generate_idea_comments_xlsx":31.06782901974327,"XlsxService#generate_initiative_comments_xlsx":25.231329731110115,"XlsxService#generate_invites_xlsx":33.42035308012173,"XlsxService#header_style":1.3000000000000012},"history":[["1a5c88487","Fixes for the tests"],["224fcb922","Actually fixes ideas spec"],["266874332","Review fix"],["ac7367ad3","Adds export"],["0409ad423","Merge pull request #1158 from CitizenLabDotCo/IN-31/routes-for-stats-data-xls-download"],["f8f3f44b1","Merge branch 'master' into epic/CL2-5764/shallow-anonymisation-for-gent"],["245238255","Merge branch 'master' into IN-31/routes-for-stats-data-xls-download"],["328f86fa0","Adds remaining user stats xlsx exports"],["779aaaf0b","Adds remaining xlsx for stats ideas exports"],["ca0fb6e76","Ideas by Topic"]]},{"file_path":"app/services/participation_context_service.rb","x":54,"y":370.1240958177444,"details":{"ParticipationContextService#initialize":5.88387627334226,"ParticipationContextService#get_participation_context":6.673080248281149,"ParticipationContextService#in_current_context?":10.088111815399353,"ParticipationContextService#participation_possible_for_context?":9.985990186255945,"ParticipationContextService#posting_idea_disabled_reason_for_project":2.5317977802344327,"ParticipationContextService#posting_idea_disabled_reason_for_context":26.691946350912673,"ParticipationContextService#commenting_disabled_reason_for_idea":10.754533927604673,"ParticipationContextService#commenting_idea_disabled_reason_for_project":2.23606797749979,"ParticipationContextService#commenting_idea_disabled_reason_for_context":26.691946350912673,"ParticipationContextService#voting_disabled_reason_for_idea_vote":10.246950765959598,"ParticipationContextService#voting_disabled_reason_for_idea_comment":2.2,"ParticipationContextService#voting_disabled_reason_for_idea":10.754533927604673,"ParticipationContextService#voting_idea_disabled_reason_for_project":2.23606797749979,"ParticipationContextService#voting_idea_disabled_reason_for_context":35.958865388107014,"ParticipationContextService#cancelling_votes_disabled_reason_for_idea":34.307725077597325,"ParticipationContextService#taking_survey_disabled_reason_for_project":2.23606797749979,"ParticipationContextService#taking_survey_disabled_reason_for_context":21.54576524517057,"ParticipationContextService#taking_poll_disabled_reason_for_project":2.23606797749979,"ParticipationContextService#taking_poll_disabled_reason_for_context":28.24641570181959,"ParticipationContextService#budgeting_disabled_reason_for_idea":7.1582120672693135,"ParticipationContextService#budgeting_disabled_reason_for_context":16.720047846821497,"ParticipationContextService#future_posting_idea_enabled_phase":9.853933224860013,"ParticipationContextService#future_commenting_idea_enabled_phase":11.66747616239262,"ParticipationContextService#future_voting_idea_enabled_phase":11.66747616239262,"ParticipationContextService#future_comment_voting_idea_enabled_phase":2.2360679774997902,"ParticipationContextService#future_budgeting_enabled_phase":8.210359310042406,"ParticipationContextService#moderating_participation_context_ids":4.651881339845203,"ParticipationContextService#allocated_budget":5.2,"ParticipationContextService#allocated_budgets":7.000000000000001,"ParticipationContextService#none":1.0000000000000002,"ParticipationContextService#votes_in_context":4.2,"ParticipationContextService#calculate_votes_in_context":5.0,"ParticipationContextService#context_permission":6.082762530298221,"ParticipationContextService#groups_by_permission_id":6.511528238439883,"ParticipationContextService#requires_verification?":7.116881339463236,"ParticipationContextService#not_signed_in?":4.341658669218483},"history":[["fe671cc67","fixed tests and policy"],["964645404","refactoring comment and voting disabled reasons"],["891d829d9","return not verified when not signed in but rule requires verification"],["788b83e67","fixes pc servce spec"],["3266a4de3","more refactoring work"],["f9a6a23e2","Revert \"Revert \"CL2-5186 Granular permissions default to registered users\"\""],["1fc20ba7e","Revert \"CL2-5186 Granular permissions default to registered users\""],["1e1472265","manual merge"],["4ae4941a2","fixed not_verified returned for verified users"],["ed8fd9ddf","added cases for not_signed_in to pc service + spec + updated seedfile"]]},{"file_path":"app/services/side_fx_idea_service.rb","x":45,"y":133.77252605001294,"details":{"SideFxIdeaService#none":3.0,"SideFxIdeaService#initialize":1.0,"SideFxIdeaService#before_create":2.3259406699226015,"SideFxIdeaService#after_create":5.7870545184921145,"SideFxIdeaService#before_update":12.492397688194206,"SideFxIdeaService#after_update":34.60014450836874,"SideFxIdeaService#before_destroy":4.173727350941841,"SideFxIdeaService#after_destroy":9.414881836751855,"SideFxIdeaService#before_publish":2.0,"SideFxIdeaService#after_publish":2.0,"SideFxIdeaService#set_phase":13.023440405668543,"SideFxIdeaService#set_assignee":8.12465383877984,"SideFxIdeaService#add_autovote":9.901515035589252,"SideFxIdeaService#first_user_idea?":11.169853401007552,"SideFxIdeaService#log_activity_jobs_after_published":14.7589167962964},"history":[["1a5c88487","Fixes for the tests"],["1749435f9","Add text_image related logic to idea mode and sidefx"],["5ef844cbc","added project published events and proposed improvement idea published"],["a19675532","CL2-3612 Removed assigned event"],["073109292","requested change"],["bce5d68c4","requested changes (pt. 1)"],["712408021","minor"],["86459185d","idea assigned should be logged when publishing (both create and update) and when assignee updated but not transition to published"],["589aefdad","making it actually work (controller) + also generate event on creation"],["25b51897f","initial version differentiating between manual and auto assignment"]]},{"file_path":"app/services/invites_service.rb","x":37,"y":392.7665206704915,"details":{"main#none":1.1,"InvitesService#none":2.4750000000000005,"InvitesService::InvitesFailedError#none":1.1,"InvitesService::InvitesFailedError#initialize":1.5556349186104046,"InvitesService::InvitesFailedError#to_h":9.5,"InvitesService::InviteError#none":1.1,"InvitesService::InviteError#initialize":8.725250712730265,"InvitesService::InviteError#to_h":14.082613393827158,"InvitesService#initialize":4.304648650006177,"InvitesService#generate_token":2.7750000000000004,"InvitesService#bulk_create_xlsx":47.672273126000626,"InvitesService#bulk_create":13.457340004622019,"InvitesService#generate_example_xlsx":11.300000000000004,"InvitesService#custom_field_types":3.7643060449437438,"InvitesService#custom_field_keys":2.4000000000000012,"InvitesService#postprocess_xlsx_hash_array":35.75961409187747,"InvitesService#coerce_custom_field_types":8.515867542417512,"InvitesService#coerce_value":6.107372593840992,"InvitesService#to_number":4.356604182158395,"InvitesService#to_boolean":4.549244442761899,"InvitesService#xlsx_groups_to_group_ids":31.091638747418916,"InvitesService#xlsx_admin_to_roles":4.635798205271668,"InvitesService#build_invites":34.13869688491348,"InvitesService#build_invite":29.97031865029134,"InvitesService#check_invites":22.613989033339536,"InvitesService#validate_invite":46.84922624761273,"InvitesService#save_invites":24.338652386687347,"InvitesService#add_error":4.052159917870966,"InvitesService#fail_now":2.400000000000003,"InvitesService#ignored_invites":8.075270893288977},"history":[["39450d2fd","migrated invite email"],["3646d8692","CL2-5970 Allow specifying send_invite_email in invites xlsx"],["7663f62cb","Factored out to_number"],["662a1cd4e","CL2-5860 Fixed intended float parsing and adapted spec"],["4bb1924ff","CL2-5860 support integers in invites excel"],["ed24baf6b","adding type conversion when initializing custom fields in xlsx invites"],["95627622a","add missing \"regular\" params used to compute custom_field_values"],["0222d80c2","initialize custom fields from xlsx invites + fix test + new 'unknown_custom_field' error"],["0b0e7e75f","renaming User.display_name to User.full_name"],["9f837a53c","CL2-5110 Added invites to admin_api"]]},{"file_path":"app/services/trending_idea_service.rb","x":32,"y":100.18783287409948,"details":{"TrendingIdeaService#filter_trending":3.3526109228480423,"TrendingIdeaService#sort_trending":3.3526109228480423,"TrendingIdeaService#with_trending_score":16.918628786045282,"TrendingIdeaService#trending_score":53.419191307993415,"TrendingIdeaService#trending?":2.2,"TrendingIdeaService#none":1.0,"TrendingIdeaService#trending_score_formula":5.9,"TrendingIdeaService#activity_ago":7.764663547121665,"TrendingIdeaService#mean":6.280127387243032},"history":[["8c28e2ed9","added basic tests"],["881761645","Simplified filter_trending"],["5b4303b38","CL2-2785 Simplified trending idea service and fixex related spec error"],["61a5f265c","CL2-2787 Fixed failing save of new campaign"],["54dd269f9","CL2-2787 Updated rails to 5.2.1"],["335e956bc","minor"],["6c4bf83df","revert revert"],["eda75333d","Revert \"Cl2 946 trending algo\""],["c5f3d05f2","fixed?"],["f89c04fc7","filter trending on created_at instead of last_activity_at"]]},{"file_path":"app/services/sanitization_service.rb","x":32,"y":82.50107419849704,"details":{"SanitizationService#none":4.0,"SanitizationService#sanitize":4.670117771534247,"SanitizationService#sanitize_multiloc":4.976946855251722,"SanitizationService#remove_multiloc_empty_trailing_tags":4.976946855251722,"SanitizationService#remove_empty_trailing_tags":12.181132952233963,"SanitizationService#linkify_multiloc":5.431390245600108,"SanitizationService#linkify":1.0,"SanitizationService#html_with_content?":2.23606797749979,"SanitizationService#last_structure_node":3.5608987629529714,"SanitizationService#with_content?":5.147815070493501,"SanitizationService#remove_hidden_spaces":2.0,"SanitizationService::IframeScrubber#none":5.0,"SanitizationService::IframeScrubber#initialize":11.651609330903607,"SanitizationService::IframeScrubber#allowed_node?":8.271033792700885,"SanitizationService::IframeScrubber#video_whitelisted?":5.197114584074513,"SanitizationService::IframeScrubber#iframe_allowed?":2.2},"history":[["2d57dc9c1","Urgent fix for CL2-6092"],["51424ab8c","uncommented private"],["5ca9bd71b","fixed tests"],["30cbeb539","merged"],["1fecb349d","tested locally and everything is ok"],["b23cb1981","tested locally and everything is ok"],["72406dec3","fixed trailing images issue"],["a911419f3","sanitize nil values in multilocs"],["8921a5ea4","add test that checks for tags included in sanitizer"],["fd72e9c60","copy paste fix"]]},{"file_path":"app/services/side_fx_user_service.rb","x":31,"y":127.62839384904083,"details":{"SideFxUserService#none":3.0000000000000004,"SideFxUserService#before_create":25.07349197858169,"SideFxUserService#after_create":23.709504950546734,"SideFxUserService#after_update":56.777685977855775,"SideFxUserService#after_destroy":8.062257748298553,"SideFxUserService#lost_roles":5.502726596879045,"SideFxUserService#gained_roles":5.502726596879045},"history":[["bd0a3fc5b","Adds Intercom, refactors segment"],["224e0f73a","CL2-5018 Auto convert phone to email when registering"],["d0ea4ee9c","CL2-4914 separated custom field service from user service"],["9f284cd83","CL2-4914 Made current usage of custom_fields restricted to resource_type 'User'"],["3ac730dca","Merge branch 'master' into CL2-4652-auto-lp-admin"],["47dd7dae8","get user by email in admin api"],["acc2c466b","CL2-4748 Added unsubscription token to admin_api"],["5cc9fe5a7","substituted .count to .size where it makes sense"],["16db5b4e9","Switched around project and idea unassignment in user side fx"],["7e8e85855","CL2-3405 auto unassign default_assignee when user role changes"]]},{"file_path":"app/services/smart_groups_service.rb","x":25,"y":54.20769308359632,"details":{"main#none":1.1,"SmartGroupsService#none":5.069516742254631,"SmartGroupsService#filter":5.128352561983234,"SmartGroupsService#groups_for_user":24.627220712049496,"SmartGroupsService#generate_rules_json_schema":3.764306044943743,"SmartGroupsService#parse_json_rules":2.5495097567963927,"SmartGroupsService#parse_json_rule":3.6687872655688287,"SmartGroupsService#filter_by_rule_type":2.4000000000000004,"SmartGroupsService#filter_by_rule_value":2.4000000000000004,"SmartGroupsService#each_rule":2.4000000000000004,"SmartGroupsService#rule_type_to_class":1.1},"history":[["ac3782e80","CL2-4827 Added methods to filter smart groups by rule attributes"],["b27f7f8e0","rule_type as method everywhere"],["586dfe675","initial test case"],["1a248652b","added verified smart group rule"],["24cdad825","added participated in topic and idea status rules"],["ac50707fd","initial service functionality for anonymizing users"],["4ff57e177","Improved logging and fixed some deprecations"],["e28866332","groups_inclusion endpoint"],["a70d03334","Added participated_in_project rule to SmartGroupsService"],["a23c1683f","custom number field smart group filter"]]},{"file_path":"app/services/text_image_service.rb","x":25,"y":101.78621816862466,"details":{"TextImageService#swap_data_images":39.377404688475856,"TextImageService#render_data_images":62.40881348014881},"history":[["efb108138","minor cleanup"],["eb66a778a","urgent switch"],["5c2b78ff9","add imageable created at to additional data"],["ee4a35d77","deal with missing references without 500"],["30db62bda","fixed issue with base references and keep fixing images when issues"],["a20455384","dont render campaing in transaction + requested change: improve render data images performance"],["3b97c7e14","rendering text images + update script to sync tenants"],["a112f1676","speced and fixed new text image service"],["b4daa9b4f","fixed text image service"],["affb91e5a","refactored text image service + added method for rendered version + added index on ti text ref"]]},{"file_path":"app/services/side_fx_project_service.rb","x":24,"y":81.52972168232006,"details":{"SideFxProjectService#none":3.0,"SideFxProjectService#initialize":2.23606797749979,"SideFxProjectService#before_create":3.2572994949804666,"SideFxProjectService#after_create":13.746272221951665,"SideFxProjectService#before_update":4.52658811910251,"SideFxProjectService#after_update":10.590561835898981,"SideFxProjectService#before_destroy":8.558621384311845,"SideFxProjectService#after_destroy":11.388151737661383,"SideFxProjectService#after_publish":6.6000000000000005,"SideFxProjectService#remove_moderators":6.082762530298219,"SideFxProjectService#set_default_assignee":11.543396380615198},"history":[["5b9bfeed2","added routes and model mixins and added ideas_order fields"],["5ef844cbc","added project published events and proposed improvement idea published"],["0c17f3ffb","set default topics of project outside model"],["e63012365","fixes for introduced failing cases"],["b2be883ff","fixed projects endpoint, except changing folder"],["7cbfacb29","added pubstat area and topics filters for holders"],["29f9b5e43","minor"],["2ceb364cb","fixes changing project publication status"],["ea66bcb4d","changing folder of projects"],["0c5727c4d","ensure project holder orderings when changing project stuff"]]},{"file_path":"app/services/custom_field_service.rb","x":24,"y":182.05793845375868,"details":{"CustomFieldService#none":3.0,"CustomFieldService#initialize":1.4142135623730951,"CustomFieldService#fields_to_json_schema_multiloc":4.9295030175464944,"CustomFieldService#fields_to_json_schema":38.917091360994604,"CustomFieldService#fields_to_ui_schema_multiloc":6.006662967072482,"CustomFieldService#fields_to_ui_schema":30.784086798214435,"CustomFieldService#generate_key":7.89255978754675,"CustomFieldService#keyify":2.2,"CustomFieldService#cleanup_custom_field_values!":6.168468205316454,"CustomFieldService::remove_hidden_custom_fields":5.758472019555188,"CustomFieldService::remove_disabled_custom_fields":5.758472019555188,"CustomFieldService#handle_description":3.54400902933387,"CustomFieldService#handle_title":3.54400902933387,"CustomFieldService#base_ui_schema_field":6.905070600652829,"CustomFieldService#text_to_ui_schema_field":1.0,"CustomFieldService#text_to_json_schema_field":2.0,"CustomFieldService#number_to_ui_schema_field":1.0,"CustomFieldService#number_to_json_schema_field":2.0,"CustomFieldService#multiline_text_to_ui_schema_field":2.449489742783178,"CustomFieldService#multiline_text_to_json_schema_field":2.0,"CustomFieldService#select_to_ui_schema_field":1.0,"CustomFieldService#select_to_json_schema_field":15.654072952429985,"CustomFieldService#multiselect_to_ui_schema_field":1.0,"CustomFieldService#multiselect_to_json_schema_field":18.131757361050255,"CustomFieldService#checkbox_to_ui_schema_field":1.0,"CustomFieldService#checkbox_to_json_schema_field":2.0,"CustomFieldService#date_to_ui_schema_field":1.0,"CustomFieldService#date_to_json_schema_field":2.0,"CustomFieldService#files_to_ui_schema_field":1.0,"CustomFieldService#files_to_json_schema_field":2.0},"history":[["d09920c81","removing disabled custom fields from serialized users"],["bed91f821","test & fix"],["d41ab390a","reformatting file"],["7b12d43d5","improving performance: modify the /phrasing/ to make caching possible"],["5796909a3","refactoring move to the appropriate service"],["4a51761b4","hide hidden fields in the UI (profile edit page)"],["9ad2691f7","CL2-4921 Added json schema for idea custom fields"],["366300d71","CL2-4914 Fixed and separated user overrides"],["d0ea4ee9c","CL2-4914 separated custom field service from user service"],["1bd36ad33","Merge branch 'master' into CL-4324-solution-2"]]},{"file_path":"app/services/participants_service.rb","x":22,"y":154.20980013582388,"details":{"ParticipantsService#none":2.25,"ParticipantsService#participants":19.686797606517924,"ParticipantsService#ideas_participants":38.054303304619836,"ParticipantsService#project_participants":6.213091018164792,"ParticipantsService#projects_participants":56.936543625337855,"ParticipantsService#topics_participants":6.324555320336759,"ParticipantsService#idea_statuses_participants":2.8284271247461903,"ParticipantsService#filter_engaging_activities":13.695984813075693,"ParticipantsService#with_engagement_scores":8.220097323024833},"history":[["423ed21ac","added participants_count to projects serializers"],["523221c58","Added volunteering to participants and project smart group rule"],["c7c78fc8e","polling participants spek and working"],["f02b47f48","now its fixed"],["dc98140f0","manual merge"],["d2101141b","minor the snd"],["3233d8691","added actions option to participants service"],["74228387d","Merge branch 'master' into epic/CL2-3456-better-comments"],["002fd8403","into the multiwhere"],["8a1446f47","more fixing and nex PARTICIPANT_ACTIVITY_TYPES"]]},{"file_path":"app/services/permissions_service.rb","x":22,"y":135.42039039880552,"details":{"PermissionsService#initialize":1.4142135623730951,"PermissionsService#update_global_permissions":16.57709262808168,"PermissionsService#update_permissions_for_context":23.212281232140885,"PermissionsService#update_permissions_for_current_tenant":18.70106948813356,"PermissionsService#posting_initiative_disabled_reason":13.33641631023867,"PermissionsService#commenting_initiative_disabled_reason":13.33641631023867,"PermissionsService#voting_initiative_disabled_reason":13.33641631023867,"PermissionsService#cancelling_votes_disabled_reason_for_initiative":13.33641631023867,"PermissionsService#voting_disabled_reason_for_initiative_comment":1.0,"PermissionsService#none":1.0,"PermissionsService#global_permission":2.2,"PermissionsService#requires_verification?":7.1168813394632355,"PermissionsService#groups_by_permission_id":6.511528238439882,"PermissionsService#not_signed_in?":4.341658669218482},"history":[["5b9bfeed2","added routes and model mixins and added ideas_order fields"],["dd3ad5793","initiative permissions"],["964645404","refactoring comment and voting disabled reasons"],["57fc2e53b","granular permissions for posting initiatives"],["da1995f77","added granular posting permission for initiatives"],["a91b7c12c","merge master"],["a4ed00314","refactoring in permissions service"],["f9a6a23e2","Revert \"Revert \"CL2-5186 Granular permissions default to registered users\"\""],["1fc20ba7e","Revert \"CL2-5186 Granular permissions default to registered users\""],["390ec0038","permissions default to users + minor fix type"]]},{"file_path":"app/services/side_fx_tenant_service.rb","x":21,"y":65.89074123933017,"details":{"SideFxTenantService#none":3.0,"SideFxTenantService#after_create":3.5999999999999996,"SideFxTenantService#after_apply_template":12.240914998479486,"SideFxTenantService#after_update":30.156632769591504,"SideFxTenantService#before_destroy":4.707440918375927,"SideFxTenantService#after_destroy":7.071067811865476,"SideFxTenantService#update_group_by_identify":5.1146847410177685},"history":[["dca71cda5","Fixed wrong TrackUserJob references"],["db20262f1","Many fixes"],["bd0a3fc5b","Adds Intercom, refactors segment"],["dc86bbb06","fixing project copy and other remaining issues"],["8d43d6969","ensure template loaded event"],["93ec29ce5","reverted unneeded changes and fixed first user made admin spec"],["1011c3100","log when tenant name changes and add constraints"],["958eb0e22","working version for tenant creation!!"],["5d6a5be61","solved update + need event for when tenant is really created + issue admin HQ with rails 6 host witelist (disabled)"],["492846e67","minor fixed minor"]]},{"file_path":"app/services/clustering_service.rb","x":19,"y":0,"details":{},"history":[["054ec28ce","moved clustering service to NLP engine"],["bfe7d4232","modified dump_all_tenants_to_nlp task to execute in job"],["ea68e2ce2","changed get clustering to post and minor fixes in support for clustering level"],["ccd7cfb3e","weird syntax err fix..."],["4e99d4569","mocking NLP requests for implementation (and testing) of NLP clustering level"],["d0da06485","towards clustering with nlp in backend"],["52ecc2b6b","Added NLP engine and WIP on cl2-nlp API wrapper"],["6ef13b13f","better multiline sql strings"],["f7ef4cdee","use a right outer join instead of a full outer join"],["c02b1d3fa","area_ids_to_idea_ids in one query"]]},{"file_path":"app/services/mention_service.rb","x":18,"y":75.19858507477727,"details":{"MentionService#user_to_mention":1.0,"MentionService#extract_expanded_mention_users":7.049113419430843,"MentionService#add_span_around":8.052328855678958,"MentionService#process_mentions":15.271214751944258,"MentionService#new_mentioned_users":5.758472019555188,"MentionService#users_from_post":15.464798737778645,"MentionService#none":1.0,"MentionService#remove_expanded_mentions":16.076069171286868,"MentionService#extract_mentions":4.52658811910251,"MentionService#mention_to_slug":1.0},"history":[["68f347fa6","avoid to inject 'nil' into the list of users"],["3c4e5b88c","author_id instead to avoid instantiation of the author object, also this would give an error for ideas of deleted users."],["dbe9d326a","mentions should be @<slug>"],["b5f8d88f9","adapt mention controller for shallow anonymization"],["19471ea03","clear up the interface (private methods)"],["4540bd775","delete unused method"],["dfe993e5d","doc types (+ bit of refactoring)"],["0b0e7e75f","renaming User.display_name to User.full_name"],["49801fd02","changed mentions/users endpoint for posts and no more idea->post everywhere for comments in specs"],["c06e7dfe1","lots of minors"]]},{"file_path":"app/services/single_sign_on_service.rb","x":18,"y":0,"details":{},"history":[["e9bbd8ef1","Separated auth/verification methods, flow WIP"],["06459bcd9","CL2-4538 Split up verification methods"],["2fbf26a15","WIP Bosa authentication omniauth config"],["7a8f462ed","Moved FrontendService and manifest controller to frontend engine"],["14407c520","CL2-2945 Fix social sign up through google"],["575a1fc0a","CL2-2922 Email should remain modifiable"],["9e17ab0a3","CL2-2922 Fix updating custom_field_values, made signout more robust, fix user creation"],["eefd0d40f","CL2-2922 Disallow changing data fields controlled by FranceConnect"],["30bd11894","Refactored SignOnService to better isolate providers"],["2b73e84f5","CL2-2771 Support sign out for France Connect"]]},{"file_path":"app/services/side_fx_invite_service.rb","x":15,"y":41.019019176613355,"details":{"SideFxInviteService#none":2.0,"SideFxInviteService#after_create":6.6000000000000005,"SideFxInviteService#before_accept":8.51821577561874,"SideFxInviteService#after_accept":16.82973558912914,"SideFxInviteService#after_destroy":7.071067811865476},"history":[["dca71cda5","Fixed wrong TrackUserJob references"],["bd0a3fc5b","Adds Intercom, refactors segment"],["d0ea4ee9c","CL2-4914 separated custom field service from user service"],["9f284cd83","CL2-4914 Made current usage of custom_fields restricted to resource_type 'User'"],["a0fff18c0","not speced but maybe fixed"],["0bb0e8bcc","added invite received campaign"],["1e2872f21","set complete registration also when accepting invite with no custom fields and creating user normal way with no custom enabled fields, also send completed_registration event always after save"],["967d636fc","Moved avatar generating to background job, reduced sidekiq concurrency to 5, added sidekiq web ui"],["81f7ac633","fixed by adding external serializer"],["e370110ea","added InviteAccepted notification, send also email_requested event upon invite creation, added migrations etc. almost done but cant serialize time..."]]},{"file_path":"app/services/project_copy_service.rb","x":15,"y":0,"details":{},"history":[["90ddaaa9c","moved project copy to admin api and minor fix"],["e8fd358dd","requested changes pt. 1"],["b9ceb94b5","fixed some bugs with project copy"],["4faa7f386","first working version of new project copy"],["681fdb37b","speced and fixed and added the include_ideas and anonymize users options (to be tested)"],["55f08ff3d","partial first version of new project copy (now focussing on something else)"],["ba4a88f88","separated apply_template from resolve_and_apply_template, apply template from tenant for testing, and more progress in tenant_to_template"],["e1901c304","merge pls"],["2638f7766","manual merge pls"],["4ed89b114","minor fixes"]]},{"file_path":"app/services/timeline_service.rb","x":14,"y":123.54452634031247,"details":{"TimelineService#future_phases":9.467840302835699,"TimelineService#past_phases":9.467840302835699,"TimelineService#current_phase":14.136831328130079,"TimelineService#current_and_future_phases":10.989540481749,"TimelineService#is_in_active_phase?":4.8,"TimelineService#overlaps?":16.443843832875572,"TimelineService#other_project_phases":8.95600357302296,"TimelineService#timeline_active":17.177019531921133,"TimelineService#timeline_active_on_collection":32.10560698694233},"history":[["99b457068","CL2-4213 Take tenant timezone into account in timeline service"],["9e80bddec","preload timeline active"],["e19821bab","CL2-3343 Fixed idea not being assing to first phase in future timeline"],["3500a5665","moved timeline_active to timeline service"],["262e38273","fixed bug with adding phase permissions after create project factory"],["0ecf22c84","minor"],["63ea62bdb","project is active when start date of active phase equals current date"],["28297262b","moved overlaps? and other_project_phases from phase model to timeline service"],["551af246e","CL2-1660 Include last day of phase as active"],["78a4dc024","Moved the disabled reasons for voting/commenting to the idea level and improved the logic"]]},{"file_path":"app/services/side_fx_comment_service.rb","x":13,"y":77.56351472450099,"details":{"SideFxCommentService#none":4.0,"SideFxCommentService#before_create":2.0,"SideFxCommentService#after_create":4.6,"SideFxCommentService#before_update":3.7416573867739418,"SideFxCommentService#after_update":11.443775600735975,"SideFxCommentService#after_mark_as_deleted":3.5999999999999996,"SideFxCommentService#after_destroy":7.071067811865476,"SideFxCommentService#check_participation_context":9.487887014504336,"SideFxCommentService#process_mentions":7.313002119512889,"SideFxCommentService#notify_mentioned_users":10.931148155614762,"SideFxCommentService#notify_updated_mentioned_users":13.374976635493612},"history":[["13b24b8d4","comment endpoints all fixed"],["a245ac3b7","Merge pull request #548 from CitizenLabDotCo/epic/CL2-2963-landing-page-i2"],["7b6e52d5c","CL2-3276 Fixed commenting_disabled_reasons for comments side fx"],["e35736f82","added processing of mentions to official feedback sidefx service"],["849c6c1b5","towards implementation of voting and commenting permissions"],["67c8fe258","added test for admin trying to modify a comment, fixed the others and log both general change as well as specific changes"],["406ff3960","cleaner comment controller, log activity for body changed, and new schema"],["8f6f062d4","user instead of current_user in policy and update body_updated_at whe body updated"],["eab487d93","added mad activity and notification, done except for debugging and testing"],["949f1b89a","added mad action in comments controller, and added publication status attribute"]]},{"file_path":"app/services/initiative_status_service.rb","x":13,"y":100.05177853200962,"details":{"InitiativeStatusService#none":18.806647760831808,"InitiativeStatusService#transition_allowed?":6.435060217278469,"InitiativeStatusService#automated_transitions!":30.323753065872317,"InitiativeStatusService#allowed_transitions":14.305593311708538,"InitiativeStatusService#transition_type":3.5440090293338704,"InitiativeStatusService#manual_status_ids":13.0,"InitiativeStatusService#log_status_change":13.63671514698463},"history":[["cbb70491c","merge pls"],["0ef0a50b4","requested changes pt. 1"],["d6e123793","immediately change status after voting"],["c9b10aec8","all things initiative campaigns!"],["b567a7a27","added transition_type attribute to initiative status"],["d1b77fd92","fixing auto status changes"],["74f2b3e87","towards automatic transitions and added more allowed manual transitions"],["399c5dc22","minorrr"],["5fe067311","minor"],["ca6bef971","first version of initiative status change modeling"]]},{"file_path":"app/services/projects_filtering_service.rb","x":13,"y":20.981449717480444,"details":{"ProjectsFilteringService#none":2.0,"ProjectsFilteringService::add_filter#by_topics":3.64828726939094,"ProjectsFilteringService::add_filter#by_areas":5.8728187440104085,"ProjectsFilteringService::add_filter#filter_ids":3.64828726939094,"ProjectsFilteringService::add_filter#by_moderator":5.812056434688156},"history":[["7faf835b6","fix filtering by moderator"],["c75c20b5d","refactoring and fixes to the admin_publications and projects filtering services."],["1075747c2","refactoring project and admin publication filters"],["35cf2ad66","refactoring of projects_filtering_service.rb to be able to register filters dynamically."],["ad2e83f2d","renaming ProjectFolders classes"],["12c2685dc","listing projects by publication status for admins"],["da003555a","fixed current admin publications endpoint"],["b4d526f48","Actually gets back all projects whatever the publication status"],["773cf955e","Changes the default behaviour of projects endpoint, returns all publication statuses"],["7d2c6a820","return archived and published projects by default"]]},{"file_path":"app/services/avatars_service.rb","x":13,"y":60.95769550928255,"details":{"AvatarsService#initialize":2.23606797749979,"AvatarsService#avatars_for_project":10.121264743103996,"AvatarsService#avatars_for_group":10.121264743103996,"AvatarsService#avatars_for_post":17.19767426136453,"AvatarsService#avatars_for_idea":2.25,"AvatarsService#avatars_for_initiative":2.25,"AvatarsService#avatars_for_tenant":6.181423784210236,"AvatarsService#none":1.0,"AvatarsService#add_count":3.2,"AvatarsService#with_avatars":6.4},"history":[["423ed21ac","added participants_count to projects serializers"],["6bc3af33d","added avatars for initiatives"],["bf89256ca","requested changes + fixed avatars caching"],["e9987f90e","trying to cache avatars and fixed issues with avatars spec"],["5cc9fe5a7","substituted .count to .size where it makes sense"],["895f9da42","CL2-3644 Added ability to request avatars for idea"],["1da3fd62d","more bugfix, projects always and also idea status participants"],["658236ed5","allow participants multiple projects (consistency) and bugfix"],["23b9cfd70","split up participants functions in ideas, project, topics and overall"],["d1d8e9f63","CL2-3322 Make avatars include all participants, included PB and improved efficiency"]]},{"file_path":"app/services/side_fx_vote_service.rb","x":12,"y":23.82411633262609,"details":{"SideFxVoteService#none":3.0,"SideFxVoteService#after_create":9.209234495874236,"SideFxVoteService#after_destroy":9.414881836751855,"SideFxVoteService#votable_type":2.2},"history":[["d6e123793","immediately change status after voting"],["6d4f8a770","immediately change status after voting"],["9bc1d5032","immediately change status after voting"],["0dfce127f","first version automatic initiative status transitions + execute hourly jobs in jobs"],["08b05bb8b","minor"],["b31a7ce9e","vote policy with voting allowed checks"],["8563969d5","Added vote cancelling action descriptor to ideas"],["78a4dc024","Moved the disabled reasons for voting/commenting to the idea level and improved the logic"],["a4f2231ef","Fixed autovote and vote deletion with new behaviour. Improved seedfile"],["21e1fe6f2","Implemented phase behaviour"]]},{"file_path":"app/services/idea_custom_field_service.rb","x":11,"y":63.43228641227729,"details":{"IdeaCustomFieldService#db_and_built_in_fields":19.704314248407634,"IdeaCustomFieldService#find_or_build_field":7.7884529914483025,"IdeaCustomFieldService#none":1.0,"IdeaCustomFieldService#build_built_in_fields":34.939519172421356},"history":[["b6c2a0e9d","Moved proposed_budget order up in idea custom fields"],["c6f1ced9a","renaming (WATCHOUT I didn't rename the 'estimated_budget' col using a migration since it has not been deployed yet)"],["cc800947d","CL-5694 / Add estimated budget option in the idea-form config panel (#1144)"],["4c84c345d","Retain sorting order of built-in custom fields"],["9ad2691f7","CL2-4921 Added json schema for idea custom fields"],["b84ac9247","CL2-4907 Validate built-in fields"],["c024ffd3d","CL2-4907 Added all built in fields for ideas"],["d5b7b0e01","CL2-4908 post -> idea and fixed 2 bugs"]]},{"file_path":"app/services/frontend_service.rb","x":11,"y":0,"details":{},"history":[["7a8f462ed","Moved FrontendService and manifest controller to frontend engine"],["c86805f20","CL2-2516 Added variables for campaign email template"],["a0c89005e","manifest.json by taking first locale"],["a11698ddf","minor fix"],["0c03693ee","minor"],["31645c7ef","added locale into frontend urls wherever possible to figure out"],["0dbe74e6f","WIP. Added working endpoints for invite bulk_create and bulk_create_xlsx. Error handling todo."],["ca92bd4ae","testing accept invite, add accept invite url to serializer"],["7de321081","Fixed social sign in redirection when already registered"],["9fad6d614","created frontend_service and added background image in notification project serialization"]]},{"file_path":"app/services/user_display_name_service.rb","x":11,"y":42.52994064088074,"details":{"UserDisplayNameService#initialize":5.3814496188294845,"UserDisplayNameService#display_name":7.269112738154498,"UserDisplayNameService#display_name!":4.512205669071391,"UserDisplayNameService#last_name":7.66550715869472,"UserDisplayNameService#last_name!":7.088018058667741,"UserDisplayNameService#restricted?":3.6400549446402595,"UserDisplayNameService#none":1.0,"UserDisplayNameService#can_see_fullname_of?":3.773592452822642,"UserDisplayNameService::initial":2.2},"history":[["7a36acf38","- removing useless method - renaming to turn_on_abbreviated_user_names! to make the intent explicit."],["88c6b1c7d","extracting the restricted condition -> will be used in IdeasController"],["07dc0b3c8","better condition: line #1 depends on the instance / line #2 depends on the 'user'"],["26a0300f7","better name"],["932836bff","introduced nil-friendly versions of display_name and last_name"],["e24fff47d","renaming for better consistency"],["7f91fd4f7","fix: admin names are not anonymized + test"],["e0c3b652a","admin names are not anonymized"],["5cf1b5846","take into account nil current_user"],["19e2f4c38","New service to adapt the display name according to the context"]]},{"file_path":"app/services/log_to_segment_service.rb","x":10,"y":0,"details":{},"history":[["bd0a3fc5b","Adds Intercom, refactors segment"],["5120a3113","CL2-4665 Added cl2_cluster to event payload"],["30158f8eb","Prevents user info to get to admin destinations"],["99a527583","CL2-3265 Added logic to only send admin/moderator data to intercom"],["3398d33e9","bugfixes and specfixes after deletion of external serializers"],["5309fe47e","no more external serializers in log to segment"],["2b1f72298","Removed hard coupling of event flow with notifications"],["c6e11c391","changed helper functions for composing events (segment, bunny, periodic events / activities)"],["bc6657ee8","serialize helper function for events"],["a78d901dd","log to segment service for activities and also applied for bunny and periodic events"]]},{"file_path":"app/services/posts_filtering_service.rb","x":9,"y":94.60839746330521,"details":{"PostsFilteringService#apply_common_idea_index_filters":47.79801251098208,"PostsFilteringService#apply_common_initiative_index_filters":25.63688748658854,"PostsFilteringService#none":1.0,"PostsFilteringService#apply_common_post_index_filters":20.17349746573459},"history":[["8a48d3785","dont include last_name in idea search when abbreviated_user_names is enabled"],["3df01318e","parameter to restrict idea search"],["e52927dd8","nice view fixed"],["ec7f8f027","initiative statuses with a nice view"],["da6001630","an ugly way to join initiatives with their statuses"],["0952cab4e","feedback needed for initiaitives"],["ad8203ecd","second part of requested changes"],["6e5c6e27f","added initiative statuses"],["8cba85e03","filtering and sorting options for initiatives"]]},{"file_path":"app/services/multiloc_service.rb","x":9,"y":31.424767857690426,"details":{"MultilocService#t":14.347473645210156,"MultilocService#i18n_to_multiloc":5.7870545184921145,"MultilocService#block_to_multiloc":5.10881590977792,"MultilocService#is_empty?":6.181423784210236},"history":[["0ee2ba40b","refactored emails"],["17b71df32","CL2-3746 Added tenant settings for initiatives"],["d42943a21","CL2-2852 Added onboarding service"],["5ea418cf2","CL2-2457 CL2-2458 Make campaign serializer more dynamic and add human readable schedule"],["8f1557aeb","CL2-2300 Added campaign_type_description_multiloc to consent attributes"],["377c8d206","CL2-1749 Fixed multilingual custom field schema"],["09624903c","Fixed bug with multiloc strings that impacted xls export"],["fa57dde60","Added activity logging for ideas, comments, users and votes. CL2-237 #done"],["f2f2cd358","Added xls export. CL2-174 #done"]]},{"file_path":"app/services/reset_password_service.rb","x":9,"y":30.47791354810591,"details":{"main#none":1.1,"ResetPasswordService#generate_reset_password_token":9.389655211987288,"ResetPasswordService#token_valid?":8.963258336118624,"ResetPasswordService#secret":3.9,"ResetPasswordService#log_password_reset_to_segment":7.125},"history":[["bd0a3fc5b","Adds Intercom, refactors segment"],["c39d5c829","password reset speced and fixed"],["dc85ba883","welcome, pwd reset, ideas published"],["31645c7ef","added locale into frontend urls wherever possible to figure out"],["9dfff37b5","wait a bit before resetting password to make sure user is identified"],["854b66143","identify to segment before requesting psw reset"],["96eee9118","password reset to segment"],["fc34df94d","password reset activity to segment"],["fa5b5ab1c","Added endpoints for password reset email and reset. CL2-228 #done"]]},{"file_path":"app/services/project_holder_service.rb","x":9,"y":0,"details":{},"history":[["69bb5b88e","deleted project holder service"],["baf6b3e77","fix project holders to also make for non-published top level projects"],["b28a79dad","found a way to preserve project ordering of existing projects and also when moving projects around folders, except theres a bug in counterculter when moving around in folders and the ordering gets completely messed up"],["21fc10e60","requested changes plus template export fixes"],["868cfb805","fixed issue with service and moving out deleted folder a bit better"],["ec8f87ae0","Merge branch 'epic/CL2-4882-project-folders' of github.com:CitizenLabDotCo/cl2-back into epic/CL2-4882-project-folders"],["0c5727c4d","ensure project holder orderings when changing project stuff"],["a1c88c2b3","Merge branch 'epic/CL2-4882-project-folders' of github.com:CitizenLabDotCo/cl2-back into epic/CL2-4882-project-folders"],["c8120d683","working version of project_holder_orderings"],["999025240","urgently switching yet again"]]},{"file_path":"app/services/anonymize_user_service.rb","x":9,"y":99.1423248160605,"details":{"AnonymizeUserService#anonymized_attributes":18.641083659487183,"AnonymizeUserService#none":1.0,"AnonymizeUserService#random_custom_field_values":11.853375046795744,"AnonymizeUserService#random_birthyear":16.783622970026464,"AnonymizeUserService#pick_weighted":10.625941134788956,"AnonymizeUserService#random_first_name":4.742362280551751,"AnonymizeUserService#random_last_name":1.0,"AnonymizeUserService#random_email":2.2,"AnonymizeUserService#random_avatar_url":5.748912940721924,"AnonymizeUserService#random_bio":17.62838619953625,"AnonymizeUserService#random_registration":7.318640584152224,"AnonymizeUserService#random_verified":1.6},"history":[["35e6f776d","no empty random demographics"],["36984a95d","minor faker fix"],["181508d24","new faker date between signature"],["5a14f6fe6","Merge branch 'master' into epic/CL2-4401-verification-i1"],["fd36f22a2","CL2-4416 Added verified attribute to user"],["f71dc95a4","merge pls"],["e214f8ea4","project copy works, updated seed and template extraction"],["d1b77fd92","fixing auto status changes"],["249527595","fixed bug in user service"],["e8fd358dd","requested changes pt. 1"]]},{"file_path":"app/services/slug_service.rb","x":8,"y":55.40844362405191,"details":{"SlugService#generate_slug":9.938435490558865,"SlugService#generate_slugs":38.38724560319483,"SlugService#slugify":6.082762530298221,"SlugService#none":1.0000000000000002},"history":[["efe2f6277","CL2-5981 Added slugify specs and removed slug regex validation"],["3a09851b4","initial solution"],["5c343fba0","got specs to fail! also updated pg and fixed slug generation for nil"],["523b831da","handle case where no invites are left + updated specs"],["52b949a08","CL2-3116 Fixed inviting lots of people"],["5c6760ea0","CL2-3104 Fixes inviting invitees with equal names"],["a00022b04","Improved mentions endpoint to ignore case"],["f4500792a","Projects endpoint. CL2-178 #done"]]},{"file_path":"app/services/track_intercom_service.rb","x":7,"y":132.46731273844753,"details":{"TrackIntercomService#initialize":2.0,"TrackIntercomService#identify_user":80.38115450775763,"TrackIntercomService#identify_tenant":24.354465709598326,"TrackIntercomService#track":25.731692521091578},"history":[["cc607a3a7","IN-213 Added missing data for Intercom"],["4b35946fa","Removed redundant comment"],["b9ba1f12a","Fixed intercom integration"],["83f027a25","Added spec for intercom tracking and simplified services"],["00ed9d0ec","Should fix tenant intercom integration"],["db20262f1","Many fixes"],["bd0a3fc5b","Adds Intercom, refactors segment"]]},{"file_path":"app/services/stats_service.rb","x":7,"y":40.684739518446776,"details":{"StatsService#group_by_time":6.0,"StatsService#group_by_time_cumulative":22.791884520591974,"StatsService#filter_users_by_topic":11.892854997854805},"history":[["c816d64ea","fixed user stats error"],["851984359","Removed leftover redundant comment"],["26f5dbec9","CL2-2684 CL2-2679 WIP, only done for comments stats"],["363feaf17","CL2-2650 Votes over time (cumulative)  returns up/down/total distinction"],["155b52103","CL2-2607 Added topic filter to all users by time endpoints"],["5f5a4a0c5","CL2-2606 added cumulative by_time stats endpoints"],["01e82e15e","Analytics endpoints. CL2-211 #done"]]},{"file_path":"app/services/side_fx_moderator_service.rb","x":7,"y":24.648187929913334,"details":{"SideFxModeratorService#none":3.0,"SideFxModeratorService#after_create":7.800000000000001,"SideFxModeratorService#after_destroy":5.6,"SideFxModeratorService#remove_idea_assignments":4.8,"SideFxModeratorService#remove_project_assignments":3.448187929913334},"history":[["c1179f84d","Switched around project and idea unassignment in side fx"],["7e8e85855","CL2-3405 auto unassign default_assignee when user role changes"],["d84c15f3c","CL2-3370 Unassign ideas when users lose admin/moderator roles"],["503c09408","moderator given speced and fixed and more fixes"],["3ee6db9d6","initial version of sending admin rights received events (to be debugged for sure) and renamed moderator right events to *_given and *_received"],["910212c93","project_moderation_rights_received notification added, without serializer so I expect the awesome notification tests to fail and tell me exactly what to do next"],["eae962f10","moderator events in here now"]]},{"file_path":"app/services/activities_service.rb","x":7,"y":90.57391404173387,"details":{"ActivitiesService#create_periodic_activities_for_current_tenant":9.962429422585638,"ActivitiesService#none":1.0,"ActivitiesService#create_phase_started_activities":32.75195604845611,"ActivitiesService#create_phase_upcoming_activities":33.920826935674796,"ActivitiesService#create_invite_not_accepted_since_3_days_activities":12.938701635017331},"history":[["d58c11cea","fixed last failing specs"],["7431d609a","fixed"],["863572f1c","dont send periodic phase notifications for unpublished projects and added checks in attempt to prevent future time travel bugs"],["f038f1bb5","added periodic activity for invite not accepted since 3 days"],["bf51ac9a9","requested changes"],["6764f639f","added notification and email campaign for project_phase_upcoming"],["8ccadf311","initial version project_phase_started notification + campaign"]]},{"file_path":"app/services/project_sorting_service.rb","x":7,"y":0,"details":{},"history":[["2d5efae74","always manual sorting (no more need for feature and setting) and fixed admin publication policy spec"],["9bfda98c9","merge with master + fixed last failures"],["6f4caed30","Fixed indentation mistakes"],["c1787f71f","CL2-2981 Added action_score and cleaned up"],["7d56e4dd6","CL2-2981 WIP Added db view to calculate project sorting score"],["03b562451","CL2-2981 WIP project sorting specs and correct reference ruby implementation"],["96396a166","CL2-2981 WIP Added logic for manual project sorting to sortin service"],["db5a8209d","CL2-2981 Added spec for project_sorting_service"]]},{"file_path":"app/services/tenant_service.rb","x":6,"y":0,"details":{},"history":[["2d9261bf5","updated text images in base template"],["361060423","quickfix broken slowtests"],["ab8821e73","fixed template related issues for initiatives"],["4faa7f386","first working version of new project copy"]]},{"file_path":"app/services/import_ideas_service.rb","x":6,"y":136.60329670340565,"details":{"ImportIdeasService#none":1.2500000000000002,"ImportIdeasService#import_ideas":21.50372060830405,"ImportIdeasService#convert_idea":108.15308594765116,"ImportIdeasService#multiloculate":5.696490147450447},"history":[["0b3792617","idea import with support for multiloc title and body and publication date"],["73f71708b","quick fixes: strip when looking for title, parse csv (dunno why it suddently didnt work anymore) and generate password when exporting user with no password (how the hell can that happen)"],["045220029","bug fixed, silent fail when no project provided, project title is now mandatory, also added checks that mandatory fields are filled in and now using create! instead of create to fail with exception"],["a341b930a","created spec for service, fixed some bugs and added support for images and phases"],["7e48e121b","semicolon-separated topics and can read csv from url"],["3c6f10747","a first working version, projects not set yet"]]},{"file_path":"app/services/admin_publications_filtering_service.rb","x":5,"y":22.184374292834136,"details":{"AdminPublicationsFilteringService#none":3.0,"AdminPublicationsFilteringService::add_filter#by_publication_status":3.64828726939094,"AdminPublicationsFilteringService::add_filter#filter_projects":15.536087023443194},"history":[["6c985bd7f","registering folder filters from the engine"],["dfdd54509","work-around: add a stateful \"filter\" that computes the children counts of publications."],["c75c20b5d","refactoring and fixes to the admin_publications and projects filtering services."],["5a57111bd","fix: filtering service ought to be a class :-/"],["1075747c2","refactoring project and admin publication filters"]]},{"file_path":"app/services/side_fx_initiative_service.rb","x":5,"y":101.69272556441459,"details":{"SideFxInitiativeService#none":3.0,"SideFxInitiativeService#initialize":1.0,"SideFxInitiativeService#before_create":2.3259406699226015,"SideFxInitiativeService#after_create":5.7870545184921145,"SideFxInitiativeService#before_update":5.678908345800274,"SideFxInitiativeService#after_update":28.335313656284097,"SideFxInitiativeService#after_destroy":9.414881836751855,"SideFxInitiativeService#before_publish":1.0,"SideFxInitiativeService#after_publish":2.0,"SideFxInitiativeService#set_assignee":12.821856339859684,"SideFxInitiativeService#add_autovote":4.4,"SideFxInitiativeService#log_activity_jobs_after_published":14.7589167962964,"SideFxInitiativeService#first_user_initiative?":11.169853401007552},"history":[["b8d8452d3","also for initiatives"],["1766a8278","also create text images in after_create for pages, events and initiatives"],["d01807e3a","allow body images for initiatives"],["a29b4757e","default assignee behaviour for initiatives"],["334f9daa8","minimal initiatives CRUD"]]},{"file_path":"app/services/cl2_data_listing_service.rb","x":5,"y":43.752582935433345,"details":{"Cl2DataListingService#cl2_tenant_models":36.85620707560668,"Cl2DataListingService#timestamp_attributes":3.4481879299133342,"Cl2DataListingService#multiloc_attributes":3.4481879299133342},"history":[["6e91c6887","fix inconsistent data checker (as rake task on production)"],["6fc92e68b","added rake task to translate all content of a platform from one locale to another"],["42f038e15","everything fixed"],["b8300a121","fixed: hours->days and eager loading in development"],["902fdb223","initial version shifting timestamps + service for listing cl2 models and attributes"]]},{"file_path":"app/services/side_fx_phase_service.rb","x":5,"y":30.450936648646383,"details":{"SideFxPhaseService#none":2.0,"SideFxPhaseService#initialize":2.23606797749979,"SideFxPhaseService#before_create":1.0,"SideFxPhaseService#after_create":8.2,"SideFxPhaseService#before_update":3.3526109228480423,"SideFxPhaseService#after_update":4.6,"SideFxPhaseService#before_destroy":1.0,"SideFxPhaseService#after_destroy":8.06225774829855},"history":[["e63012365","fixes for introduced failing cases"],["03f847386","CL2-3080 Automatically setup typeform webhooks"],["315635080","create -> update_permissions_for"],["df1cde6cf","create permissions when creating part ctxt"],["ea2019c98","Added text image processing and side fx for phases"]]},{"file_path":"app/services/side_fx_area_service.rb","x":5,"y":28.652101694381102,"details":{"SideFxAreaService#none":2.0,"SideFxAreaService#after_create":3.5999999999999996,"SideFxAreaService#after_update":3.5999999999999996,"SideFxAreaService#before_destroy":12.381033882515629,"SideFxAreaService#after_destroy":7.071067811865476},"history":[["d0ea4ee9c","CL2-4914 separated custom field service from user service"],["9f284cd83","CL2-4914 Made current usage of custom_fields restricted to resource_type 'User'"],["6afc09365","CL2-4827 Delete smart group rules referencing deleted topics, areas and projects"],["2393d295b","delete domicile references upon area deletion"],["6aee4f518","added create, update and destroy for area, including spec and sidexfx service"]]},{"file_path":"app/services/authentication_service.rb","x":5,"y":11.807345007480166,"details":{"AuthenticationService#none":4.0,"AuthenticationService#method_by_provider":2.2,"AuthenticationService#logout_url":3.4073450074801643,"AuthenticationService#supports_logout?":2.2},"history":[["edf1f288c","CL2-4630 removed redundant method"],["a0012880b","CL2-4630 Handle user attribute updating"],["6fbf28c59","CL2-4539 Added verificationLocked to ui schema"],["3eae75642","CL2-4538 Refactored profile_to_user_attrs and added basic spec"],["e9bbd8ef1","Separated auth/verification methods, flow WIP"]]},{"file_path":"app/services/side_fx_official_feedback_service.rb","x":4,"y":56.40318991090145,"details":{"SideFxOfficialFeedbackService#none":4.0,"SideFxOfficialFeedbackService#before_create":1.0,"SideFxOfficialFeedbackService#after_create":4.6,"SideFxOfficialFeedbackService#before_update":2.3259406699226015,"SideFxOfficialFeedbackService#after_update":5.7870545184921145,"SideFxOfficialFeedbackService#after_destroy":7.071067811865476,"SideFxOfficialFeedbackService#process_mentions":7.313002119512889,"SideFxOfficialFeedbackService#notify_mentioned_users":10.931148155614762,"SideFxOfficialFeedbackService#notify_updated_mentioned_users":13.374976635493612},"history":[["92d3c08af","add mentionservice to SideFxOfficialFeedbackService"],["e35736f82","added processing of mentions to official feedback sidefx service"],["c803ba7b7","applied requested changes"],["1d8d16193","renamed admin_feedback to official_feedback"]]},{"file_path":"app/services/user_service.rb","x":4,"y":0,"details":{},"history":[]},{"file_path":"app/services/side_fx_custom_field_option_service.rb","x":4,"y":20.871067811865476,"details":{"SideFxCustomFieldOptionService#none":2.0,"SideFxCustomFieldOptionService#after_create":3.5999999999999996,"SideFxCustomFieldOptionService#after_update":3.5999999999999996,"SideFxCustomFieldOptionService#before_destroy":4.6,"SideFxCustomFieldOptionService#after_destroy":7.071067811865476},"history":[["d0ea4ee9c","CL2-4914 separated custom field service from user service"],["dcac89309","added script to fix existing tenants"],["74b46c77f","delete custom field option values from user when deleting custom field option"],["a083d0b29","Added endpoint for custom field options"]]},{"file_path":"app/services/side_fx_basket_service.rb","x":4,"y":21.874731525076506,"details":{"SideFxBasketService#none":2.0,"SideFxBasketService#after_create":4.6,"SideFxBasketService#after_update":5.7870545184921145,"SideFxBasketService#after_destroy":7.071067811865476,"SideFxBasketService#update_basket_counts":2.4166091947189146},"history":[["9ea9c71a0","CL2-2798 Removed commented out code"],["1c7b2d456","CL2-2798 Replaced basket count updating with SQL query"],["8a304e58b","decrement idea counts when unsubmitting a basket"],["8dbb6c2df","added side fx basket service"]]},{"file_path":"app/services/side_fx_participation_context_service.rb","x":3,"y":34.18869582371069,"details":{"SideFxParticipationContextService#none":2.0,"SideFxParticipationContextService#initialize":2.23606797749979,"SideFxParticipationContextService#after_create":5.6000000000000005,"SideFxParticipationContextService#after_update":18.552627846210896,"SideFxParticipationContextService#before_destroy":5.8},"history":[["d4cf03a75","minor fixes"],["9c5ca630a","CL2-3081 Save incoming webhooks as survey responses"],["03f847386","CL2-3080 Automatically setup typeform webhooks"]]},{"file_path":"app/services/side_fx_project_folder_service.rb","x":3,"y":0,"details":{},"history":[["510f5ba6b","extracting project folders from the main app to a dedicated engine"],["5fcf97d6c","project folders endpoint fixed"],["800ca6db6","folder crud fixes with some remaining issues"]]},{"file_path":"app/services/track_segment_service.rb","x":3,"y":59.860940007166576,"details":{"TrackSegmentService#identify_user":20.506096654409884,"TrackSegmentService#identify_tenant":16.861198059449986,"TrackSegmentService#track":18.093645293306707,"TrackSegmentService#integrations":4.4},"history":[["79624d171","Updated simple_segment"],["83f027a25","Added spec for intercom tracking and simplified services"],["bd0a3fc5b","Adds Intercom, refactors segment"]]},{"file_path":"app/services/social_auth_service.rb","x":3,"y":0,"details":{},"history":[["adc39ab05","Refactored behaviour to service, added tests and added commented out mydigipass and twitter"],["0ef79a973","Iprovements to social login/registration flow. CL2-45"],["e9dfd43e3","Working social registration. Edge cases, error handling and tests todo. WIP CL2-45"]]},{"file_path":"app/services/settings_service.rb","x":3,"y":66.68023766075359,"details":{"SettingsService#dependencies_met?":2.2,"SettingsService#add_missing_features":9.183136719008381,"SettingsService#add_missing_settings":13.217034463146415,"SettingsService#active_features":7.810889834071404,"SettingsService#missing_dependencies":7.606576102294645,"SettingsService#remove_additional_features":5.885575587824865,"SettingsService#remove_additional_settings":10.482366145102928,"SettingsService#remove_private_settings":10.29465880930495},"history":[["2d309d604","Added protection for private settings"],["30ee4a4e1","Cleaned up tenant settings and improved update handling and docs"],["dc55da3b0","Feature/settings dependency checking and tests added. CL2-14 #Done"]]},{"file_path":"app/services/side_fx_custom_field_service.rb","x":3,"y":18.471067811865474,"details":{"SideFxCustomFieldService#none":2.0,"SideFxCustomFieldService#after_create":3.5999999999999996,"SideFxCustomFieldService#after_update":3.5999999999999996,"SideFxCustomFieldService#before_destroy":2.2,"SideFxCustomFieldService#after_destroy":7.071067811865476},"history":[["d0ea4ee9c","CL2-4914 separated custom field service from user service"],["0d7588c17","Render disabled custom fields as hidden and remove dangling custom_field_values for field deletion"],["dd750ecef","Functional endpoint for users/custom_fields"]]}];
